{% extends "base.html" %}

{% block content %}
<h2>📈 Prediction Results</h2>

<p><strong>Total ECG beats processed:</strong> {{ data_length }}</p>

{% if missing_cols %}
<div style="background-color: #fff3cd; padding: 15px; border-radius: 5px; margin: 15px 0;">
    <p><strong>⚠ Warning:</strong> Added missing columns with default values: {{ missing_cols|join(', ') }}</p>
</div>
{% endif %}

<!-- Summary Cards -->
<div class="summary-cards">
    {% for label, count in summary.items() %}
    <div class="summary-card">
        <h4>{{ label }} - {{ label_meaning[label] }}</h4>
        <div class="count">{{ count }}</div>
    </div>
    {% endfor %}
</div>

<!-- Detailed Results -->
<h3>📋 Detailed Results</h3>
<table class="results-table">
    <thead>
        <tr>
            <th>Beat Index</th>
            <th>Prediction</th>
            <th>Meaning</th>
            <th>View ECG Plot</th>
        </tr>
    </thead>
    <tbody>
        {% for i in range(predictions|length) %}
        <tr>
            <td>{{ i }}</td>
            <td>{{ predictions[i] }}</td>
            <td>{{ label_meaning.get(predictions[i], 'Unknown') }}</td>
            <td><a href="/plot/{{ i }}" target="_blank">View Plot</a></td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<!-- Download Results -->
<div style="margin: 30px 0; text-align: center;">
    <a href="/download_results" style="text-decoration: none;">
        <button>📥 Download Results as CSV</button>
    </a>
</div>

<!-- Navigation -->
<div style="margin: 30px 0; text-align: center;">
    <a href="/" style="text-decoration: none;">
        <button style="background-color: #6c757d;">🏠 Back to Home</button>
    </a>
</div>

{% endblock %}
